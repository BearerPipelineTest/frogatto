{
id: "particle_attache_slicer",
prototype: ["effects_attache"],
zorder: "@include data/zorder.cfg:near_player_foreground_effects",



properties: {
	child_systems: {
		type: "[obj particle_attache]",
		default: [],
		persistent: false,
	},

#-------------------------- effects_attache overrides --------------------------#
	do_setup: "execute(me, [
					initialize_position,
					create_children(child_system_count),
				])",


	
	turn_off: "map(child_systems, value.turn_off)",
	turn_on: "map(child_systems, value.turn_on)",

#-------------------------- vars --------------------------#
	_particle_type: {
		type: "string",
		dynamic_initialization: true,
	},

	child_system_count: {
		type: "int",
		default: 0,
		set: "[
			set(_data, value),
			create_children(value)
		]",
	},

#-------------------------- special setup commands --------------------------#
	create_children: "def(int number_of_systems) -> commands 
	[
		debug(number_of_systems),
		set(child_systems, 
			map(
				range(number_of_systems),
				object('particle_attache', x,y, {
					_particle_type: _particle_type,
					parent: me,
					time_to_die: 0,
					x:x, y:y,
					zorder: me.zorder,
				})
			)
		)
		;
		map(child_systems, add_object(value))
	]",
}



}
